- name: ED 8.0
  block: 
    - name: Set Facts
      set_fact:
        installerNameEDVS: edvs2022_80.exe
        installerNameEDE: ede_80.exe

    - name: Get EDVS Download URL from S3
      amazon.aws.s3_object:
        profile: '{{ awsProfile }}'
        bucket: mturner
        mode: geturl
        object: ED/80/{{ installerNameEDVS }}
        region: '{{ awsRegion }}'
        expiry: 4000
        sig_v4: true
      register: s3
      delegate_to: localhost

    - name: Download EDVS Installer
      ansible.windows.win_get_url:
        url: '{{ s3.url }}'
        dest: C:\temp\

    - name: Install EDVS
      win_package:
        path: C:\temp\{{ installerNameEDVS }}
        state: present
        arguments: /passive RumbaCheckbox=1 /log C:\temp\{{ installerNameEDVS }}.log

    - name: Get EDE Download URL from S3
      amazon.aws.s3_object:
        profile: '{{ awsProfile }}'
        bucket: mturner
        mode: geturl
        object: ED/80/{{ installerNameEDE }}
        region: '{{ awsRegion }}'
        expiry: 4000
        sig_v4: true
      register: s3
      delegate_to: localhost

    - name: Download EDE Installer
      ansible.windows.win_get_url:
        url: '{{ s3.url }}'
        dest: C:\temp\

    - name: Install EDE
      win_package:
        path: C:\temp\{{ installerNameEDE }}
        state: present
        arguments: /passive RumbaCheckbox=1 /log C:\temp\{{ installerNameEDE }}.log
  tags: ed80

# PU5
- name: ED 8.0 PU 5
  block:
    - name: Set Facts
      set_fact:
        installerNameEDVS: edvs2022_80_pu05_318648.exe
        installerNameEDE: ede_80_pu05_318643.exe

    - name: Get EDVS Download URL from S3
      amazon.aws.s3_object:
        profile: '{{ awsProfile }}'
        bucket: mturner
        mode: geturl
        object: ED/80/{{ installerNameEDVS }}
        region: '{{ awsRegion }}'
        expiry: 4000
        sig_v4: true
      register: s3
      delegate_to: localhost

    - name: Download EDVS Installer
      ansible.windows.win_get_url:
        url: '{{ s3.url }}'
        dest: C:\temp\

    - name: Install EDVS
      win_package:
        path: C:\temp\{{ installerNameEDVS }}
        state: present
        arguments: /passive RumbaCheckbox=1 /log C:\temp\{{ installerNameEDVS }}.log

    - name: Get EDE Download URL from S3
      amazon.aws.s3_object:
        profile: '{{ awsProfile }}'
        bucket: mturner
        mode: geturl
        object: ED/80/{{ installerNameEDE }}
        region: '{{ awsRegion }}'
        expiry: 4000
        sig_v4: true
      register: s3
      delegate_to: localhost

    - name: Download EDE Installer
      ansible.windows.win_get_url:
        url: '{{ s3.url }}'
        dest: C:\temp\

    - name: Install EDE
      win_package:
        path: C:\temp\{{ installerNameEDE }}
        state: present
        arguments: /passive RumbaCheckbox=1 /log C:\temp\{{ installerNameEDE }}.log
  tags: ed80pu5

# PU6

- name: ED 8.0 PU 6
  block:
    - name: Set Facts
      set_fact:
        installerNameEDVS: edvs2022_80_pu06_321069.exe
        installerNameEDE: ede_80_pu06_321065.exe

    - name: Get EDVS Download URL from S3
      amazon.aws.s3_object:
        profile: '{{ awsProfile }}'
        bucket: mturner
        mode: geturl
        object: ED/80/{{ installerNameEDVS }}
        region: '{{ awsRegion }}'
        expiry: 4000
        sig_v4: true
      register: s3
      delegate_to: localhost

    - name: Download EDVS Installer
      ansible.windows.win_get_url:
        url: '{{ s3.url }}'
        dest: C:\temp\

    - name: Install EDVS
      win_package:
        path: C:\temp\{{ installerNameEDVS }}
        state: present
        arguments: /passive RumbaCheckbox=1 /log C:\temp\{{ installerNameEDVS }}.log

    - name: Get EDE Download URL from S3
      amazon.aws.s3_object:
        profile: '{{ awsProfile }}'
        bucket: mturner
        mode: geturl
        object: ED/80/{{ installerNameEDE }}
        region: '{{ awsRegion }}'
        expiry: 4000
        sig_v4: true
      register: s3
      delegate_to: localhost

    - name: Download EDE Installer
      ansible.windows.win_get_url:
        url: '{{ s3.url }}'
        dest: C:\temp\

    - name: Install EDE
      win_package:
        path: C:\temp\{{ installerNameEDE }}
        state: present
        arguments: /passive RumbaCheckbox=1 /log C:\temp\{{ installerNameEDE }}.log
  tags: ed80pu6