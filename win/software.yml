- name: Package Installation
  win_chocolatey:
    name: 
    # - googlechrome
    - firefox
    - procmon
    - procexp
    - vcredist140
    - 7zip
    - winscp
    - notepadplusplus
    - jq
    - cascadiamono
    - ntop.portable
    # - microsoft-windows-terminal
    # - dotnet
    # - windows-sdk-11-version-22h2-all
    # - visualstudio2017buildtools
    # - office365business
    # - revo-uninstaller
    # - lockhunter
    # - adobereader
    # - insomnia-rest-api-client
    # - linkshellextension
    # - dotpeek
    # - tinytask
    # - speedtest
    # - clumsy
    state: present
  ignore_errors: true

- name: Install New Windows Terminal
  ansible.windows.win_powershell:
    script: |
      $msTermVer = "1.18.3181.0"
      $msTermURL = "https://github.com/microsoft/terminal/releases/download/v${msTermVer}/Microsoft.WindowsTerminal_${msTermVer}_x64.zip"
      Invoke-WebRequest -Uri $msTermURL -outfile C:\Users\Public\Documents\Microsoft.WindowsTerminal.zip
      Expand-Archive -LiteralPath C:\Users\Public\Documents\Microsoft.WindowsTerminal.zip -DestinationPath C:\Users\Public\Documents
      setx /m PATH "$env:PATH;C:\Users\Public\Documents\terminal-${msTermVer}"

- name: Download Oracle Instant Client 32bit
  ansible.windows.win_get_url:
    url: https://download.oracle.com/otn_software/nt/instantclient/2112000/instantclient-basic-nt-21.12.0.0.0dbru.zip
    dest: C:\temp\instantclient-basic-nt-21.12.0.0.0dbru.zip

- name: Download Oracle Instant Client 64bit
  ansible.windows.win_get_url:
    url: https://download.oracle.com/otn_software/nt/instantclient/2112000/instantclient-basic-windows.x64-21.12.0.0.0dbru.zip
    dest: C:\temp\instantclient-basic-windows.x64-21.12.0.0.0dbru.zip

- name: Unzip Oracle Instant Client 32bit
  community.windows.win_unzip:
    src: C:\temp\instantclient-basic-nt-21.12.0.0.0dbru.zip
    dest: C:\instantClient32

- name: Unzip Oracle Instant Client 64bit
  community.windows.win_unzip:
    src: C:\temp\instantclient-basic-windows.x64-21.12.0.0.0dbru.zip
    dest: C:\instantClient64

- name: Download Oracle Instant Client ODBC 32bit
  ansible.windows.win_get_url:
    url: https://download.oracle.com/otn_software/nt/instantclient/2112000/instantclient-odbc-nt-21.12.0.0.0dbru.zip
    dest: C:\temp\instantclient-basic-nt-21.12.0.0.0dbru.zip

- name: Download Oracle Instant Client ODBC 64bit
  ansible.windows.win_get_url:
    url: https://download.oracle.com/otn_software/nt/instantclient/2112000/instantclient-odbc-windows.x64-21.12.0.0.0dbru.zip
    dest: C:\temp\instantclient-basic-windows.x64-21.12.0.0.0dbru.zip

- name: Unzip Oracle Instant Client ODBC 32bit
  community.windows.win_unzip:
    src: C:\temp\instantclient-basic-nt-21.12.0.0.0dbru.zip
    dest: C:\instantClient32

- name: Unzip Oracle Instant Client ODBC 64bit
  community.windows.win_unzip:
    src: C:\temp\instantclient-basic-windows.x64-21.12.0.0.0dbru.zip
    dest: C:\instantClient64

- name: Install Oracle Instant Client ODBC 32bit
  ansible.windows.win_command: odbc_install.exe
  args:
    chdir: C:\instantClient32

- name: Install Oracle Instant Client ODBC 64bit
  ansible.windows.win_command: odbc_install.exe
  args:
    chdir: C:\instantClient64