- name: Copy ED 9.0 Installer to EC2 Instance
  copy:
    src: /products/setup_entdev_9.0_redhat_x86_64
    dest: "/home/{{ myUsername }}/MFSupport/MFInstallers/setup_entdev_9.0_redhat_x86_64"
    owner: support 
    group: support
    mode: '0775'

- name: Install ED 9.0
  command: "/home/{{ myUsername }}/MFSupport/MFInstallers/setup_entdev_9.0_redhat_x86_64 -IacceptEULA -ESadminID={{ myUsername }} -il={{ installPath }}"

- name: Add License Server
  lineinfile:
    path: /var/microfocuslicensing/bin/ces.ini
    state: present
    regexp: '^lshost'
    line: 'lshost = {{ licenseServer }}'

- name: Start MFDS
  command: tmux new -d -s mfds ". {{ installPath }}/bin/cobsetenv && {{ installPath }}/bin/mfds --UI-on && {{ installPath }}/bin/mfds --listen-all && {{ installPath }}/bin/mfds"
  environment: 
    COBDIR: '{{ installPath }}'

- name: Import JCL Region
  command: '{{ installPath }}/bin/mfds -g 5 /home/{{ myUsername }}/MFSupport/MFSamples/JCL/JCL.xml'
  environment: 
    COBDIR: '{{ installPath }}'